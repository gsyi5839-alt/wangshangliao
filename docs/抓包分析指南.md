# æ—ºå•†èŠè¸¢äºº API æŠ“åŒ…åˆ†ææŒ‡å—

## ğŸ¯ ç›®æ ‡

æ•è·æ—ºå•†èŠæ‰§è¡Œ"è¸¢å‡ºç¾¤æˆå‘˜"æ“ä½œæ—¶å‘é€çš„å®Œæ•´ HTTP è¯·æ±‚ï¼Œè·å–ï¼š
- å®Œæ•´çš„è¯·æ±‚ Headersï¼ˆç‰¹åˆ«æ˜¯ `X-Device-Id`, `X-Client-Type` ç­‰è®¾å¤‡æ ‡è¯†ï¼‰
- è¯·æ±‚ URL å’Œå‚æ•°
- è¯·æ±‚ä½“æ ¼å¼

## ğŸ“¦ æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ Fiddlerï¼ˆæ¨èï¼‰

### 1. å®‰è£…å’Œé…ç½® Fiddler

1. ä¸‹è½½ Fiddler Classic: https://www.telerik.com/download/fiddler
2. å®‰è£…åå¯åŠ¨ Fiddler

### 2. é…ç½® HTTPS è§£å¯†

1. æ‰“å¼€ Fiddler -> Tools -> Options -> HTTPS
2. å‹¾é€‰ "Capture HTTPS CONNECTs"
3. å‹¾é€‰ "Decrypt HTTPS traffic"
4. ç‚¹å‡» "Actions" -> "Trust Root Certificate"
5. å®‰è£… Fiddler è¯ä¹¦

### 3. é…ç½®æ—ºå•†èŠä»£ç†

æ–¹æ³• A - ç³»ç»Ÿä»£ç†ï¼ˆæ¨èï¼‰ï¼š
- Fiddler é»˜è®¤ä¼šè®¾ç½®ç³»ç»Ÿä»£ç† (127.0.0.1:8888)
- æ—ºå•†èŠä¼šè‡ªåŠ¨ä½¿ç”¨ç³»ç»Ÿä»£ç†

æ–¹æ³• B - å‘½ä»¤è¡Œå¯åŠ¨ï¼š
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡åå¯åŠ¨æ—ºå•†èŠ
set HTTP_PROXY=http://127.0.0.1:8888
set HTTPS_PROXY=http://127.0.0.1:8888
"C:\path\to\æ—ºå•†èŠ.exe"
```

### 4. æ‰§è¡Œè¸¢äººæ“ä½œ

1. åœ¨æ—ºå•†èŠä¸­æ‰“å¼€ç›®æ ‡ç¾¤
2. æ‰¾åˆ°è¦è¸¢å‡ºçš„æˆå‘˜ï¼ˆå¦‚"æ¡”å­"ï¼‰
3. å³é”®ç‚¹å‡» -> é€‰æ‹©"ç§»å‡ºç¾¤èŠ"
4. ç¡®è®¤æ“ä½œ

### 5. æŸ¥çœ‹æ•è·çš„è¯·æ±‚

1. åœ¨ Fiddler ä¸­æŸ¥æ‰¾åŒ…å«ä»¥ä¸‹å…³é”®è¯çš„è¯·æ±‚ï¼š
   - `group`
   - `member`
   - `remove`
   - `kick`
   - `team`

2. æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…ï¼š
   - ç‚¹å‡»è¯·æ±‚ -> Inspectors -> Headers
   - è®°å½•æ‰€æœ‰ Headersï¼Œç‰¹åˆ«æ˜¯ä»¥ `X-` å¼€å¤´çš„

3. å¯¼å‡ºè¯·æ±‚ä¿¡æ¯ï¼š
   - å³é”®è¯·æ±‚ -> Save -> Selected Sessions -> as Text

---

## ğŸ“¦ æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ mitmproxy

### 1. å®‰è£… mitmproxy

```bash
pip install mitmproxy
```

### 2. è¿è¡ŒæŠ“åŒ…è„šæœ¬

```bash
cd c:\wangshangliao
mitmproxy -s capture_wsl_requests.py
```

### 3. é…ç½®ä»£ç†

è®¾ç½®ç³»ç»Ÿä»£ç†ä¸º `127.0.0.1:8080`

### 4. å®‰è£…è¯ä¹¦

è®¿é—® `http://mitm.it` å®‰è£… mitmproxy è¯ä¹¦

---

## ğŸ“¦ æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ Charles

### 1. å®‰è£… Charles

ä¸‹è½½: https://www.charlesproxy.com/download/

### 2. é…ç½® SSL ä»£ç†

1. Proxy -> SSL Proxying Settings
2. æ·»åŠ  `*:443` æ¥è§£å¯†æ‰€æœ‰ HTTPS

### 3. å®‰è£…è¯ä¹¦

Help -> SSL Proxying -> Install Charles Root Certificate

---

## ğŸ” éœ€è¦å…³æ³¨çš„ Headers

æ ¹æ®ä¹‹å‰çš„åˆ†æï¼Œå…³é”® Headers å¯èƒ½åŒ…æ‹¬ï¼š

```
X-Device-Id: [è®¾å¤‡å”¯ä¸€æ ‡è¯†]
X-Client-Type: [å®¢æˆ·ç«¯ç±»å‹ï¼Œå¦‚ pc/electron]
X-Client-Version: [å®¢æˆ·ç«¯ç‰ˆæœ¬]
X-App-Key: [åº”ç”¨å¯†é’¥]
Authorization: Bearer [JWT Token]
Content-Type: application/json
User-Agent: [æ—ºå•†èŠ User-Agent]
```

## ğŸ“‹ è¯·æ±‚ç¤ºä¾‹ï¼ˆé¢„æœŸæ ¼å¼ï¼‰

```http
POST /v1/group/remove-group-member HTTP/1.1
Host: api.wangshangliao.com
Content-Type: application/json
Authorization: Bearer CAEQ56qTBx...
X-Device-Id: xxxx-xxxx-xxxx
X-Client-Type: electron

{
  "groupId": "1176721",
  "userId": "982576571"
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **è¯ä¹¦ä¿¡ä»»**ï¼šç¡®ä¿æ—ºå•†èŠä¿¡ä»»æŠ“åŒ…å·¥å…·çš„æ ¹è¯ä¹¦
2. **ä»£ç†é…ç½®**ï¼šç¡®ä¿æ—ºå•†èŠé€šè¿‡ä»£ç†å‘é€è¯·æ±‚
3. **è®°å½•å®Œæ•´ä¿¡æ¯**ï¼šæˆªå›¾æˆ–å¯¼å‡ºå®Œæ•´çš„è¯·æ±‚/å“åº”

## ğŸ“ ä¸‹ä¸€æ­¥

è·å–åˆ°å®Œæ•´çš„è¯·æ±‚ä¿¡æ¯åï¼Œå¯ä»¥ï¼š
1. åœ¨ C# ä»£ç ä¸­å®ç°ç›¸åŒçš„ HTTP è¯·æ±‚
2. æ·»åŠ æ­£ç¡®çš„è®¾å¤‡ Headers
3. å®ç°è‡ªåŠ¨åŒ–è¸¢äººåŠŸèƒ½
